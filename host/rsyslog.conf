module(load="imtcp")
input(type="imtcp" port="514")

# Template for filename using date function
template(name="CustomLogFile" type="string"
  string="/var/log/flowdb/syslog/collector-a/%hostname%_%timereported:1:10:date-rfc3339%%timereported:11:8:date-rfc3339%.log"
)

# Template for raw/unmodified syslog message
template(name="RawSRXLog" type="string" string="%rawmsg%\n")

# Write full raw message to dynamic file
*.* action(
  type="omfile"
  DynaFile="CustomLogFile"
  template="RawSRXLog"
  FileCreateMode="0644"
)
